/* ========================================
   BASE RESET & TYPOGRAPHY
   ======================================== */

@layer base {
/* Box sizing reset */
*, *::before, *::after { box-sizing: border-box; }

/* Smooth scrolling + prevent horizontal scroll on all pages */
html { 
  scroll-behavior: smooth;
  overflow-x: hidden; /* Prevent horizontal scroll - critical for mobile */
  max-width: 100%; /* Use 100% instead of 100vw to avoid scrollbar issues */
  width: 100%;
  /* iPhone safe area support for notch/home indicator */
  padding-left: env(safe-area-inset-left, 0);
  padding-right: env(safe-area-inset-right, 0);
}
html, body { height: 100%; }

/* Subtle background gradient for all pages */
body {
  background: 
    radial-gradient(2000px 1500px at 20% 10%, rgba(30,90,255,0.04), transparent 70%),
    radial-gradient(1800px 1400px at 80% 90%, rgba(125,107,93,0.04), transparent 70%),
    var(--bg);
  background-attachment: fixed;
  min-height: 100vh;
  margin: 0;
  color: var(--ink);
  font-family: var(--sans);
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
  font-feature-settings: 'ss01' 1, 'cv02' 1, 'cv05' 1;
  font-optical-sizing: auto;
  line-height: 1.6;
  padding-top: var(--mastH, 100px); /* Fallback 100px accommodates tagline wrap; JS sets actual value */
  overflow-x: hidden; /* Prevent horizontal scroll - critical for mobile */
  width: 100%;
  max-width: 100%;
  /* iPhone safe area support */
  padding-left: env(safe-area-inset-left, 0);
  padding-right: env(safe-area-inset-right, 0);
}

/* iOS Safari: Disable fixed background (causes gaps and performance issues) */
/* @supports (-webkit-touch-callout: none) targets iOS Safari specifically */
@supports (-webkit-touch-callout: none) {
  body {
    background-attachment: scroll;
  }
}

/* Additional landscape fix for older iOS versions */
@media (orientation: landscape) and (max-height: 500px) {
  body {
    background-attachment: scroll;
  }
}

/* Admin bar offset - JS will measure actual height, these are fallbacks */
.admin-bar .mast { top: 32px; }
.admin-bar .progress { top: 32px; }
.admin-bar .actionDock { top: calc(var(--mastH, 132px) + var(--space-4)); }
@media screen and (max-width: 782px) {
  .admin-bar .mast { top: 46px; }
  .admin-bar .progress { top: 46px; }
}

/* Link and form defaults */
a { color: inherit; text-decoration: none; }
button, select, input { font: inherit; }
::selection { background: rgba(30,90,255,.18); }
img { max-width: 100%; height: auto; display: block; }

/* Prevent any element from causing horizontal overflow on mobile landscape */
@media (max-width: 900px) and (orientation: landscape) {
  .container, main, article, section, .hero, .panorama, .mast, .home-content {
    max-width: 100%;
    width: 100%;
    overflow-x: hidden;
    box-sizing: border-box;
  }
  
  /* Ensure containers respect safe areas in landscape */
  .container, main.container, .article.container {
    padding-left: max(var(--space-4), env(safe-area-inset-left, 0));
    padding-right: max(var(--space-4), env(safe-area-inset-right, 0));
  }
}

/* Font distribution */
body, .nameLine, .nav a, .subtitle, .dek, .jText, .mailWrap, footer, select, input, button { font-family: var(--sans); }
h2 { font-family: var(--sans); font-weight: 600; letter-spacing: -0.01em; }
/* NOTE: .articleTitle is styled in pages.css with serif font - do NOT add it here */
.tTitle, .jTitle { font-family: var(--serif); font-weight: 600; letter-spacing: -0.01em; }
.count, .submeta, .meta, .jDate, .jTags, .topCounts, .articleMeta, .sectionNum, .chartCaption, .chartNote { font-family: var(--mono); }

/* ========================================
   SKIP LINKS - COMPLETELY HIDDEN
   Removed from HTML, but hide any that might be added by plugins/core
   ======================================== */
.skip-link {
  display: none !important;
  visibility: hidden !important;
  position: absolute !important;
  width: 0 !important;
  height: 0 !important;
  padding: 0 !important;
  margin: 0 !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  opacity: 0 !important;
}

/* Smooth theme transitions */
:root {
  transition: 
    background-color 300ms ease,
    color 300ms ease;
}

/* Opt-out for elements that shouldn't transition - using :where() for lower specificity */
:where(.no-theme-transition, .chart-canvas, .map-container, img, video) {
  transition: none;
}

/* Reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  :root {
    transition: none;
  }
}

/* ========================================
   TITLE CASE FIXES
   ======================================== */
/* CRITICAL FIX: Force titles to display in their natural case
 * Using :where() for lower specificity - no !important needed
 */
:where(.tTitle, .jTitle, 
.parallax-split-text h3,
.split-label,
.subscribe-section h3,
.subscribePanelContent h4) {
  text-transform: none;
  font-variant: normal;
  font-variant-caps: normal;
}

} /* End @layer base */

