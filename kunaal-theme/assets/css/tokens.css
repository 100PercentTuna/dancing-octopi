/* ========================================
   DESIGN TOKENS - Single Source of Truth
   ======================================== */

/* CSS Cascade Layers - Define layer order */
@layer tokens, base, utilities, components, blocks, pages;

/* ========================================
   COLOR TOKENS
   ======================================== */
@layer tokens {
  :root {
    /* Core colors - warmer palette */
    --k-color-bg: #FDFCFA;
    --k-color-bg-alt: #F8F6F3;
    --k-color-bg-warm: #F9F7F4;
    --k-color-bg-alt-2: #F5F3EF;
    --k-color-ink: #0b1220;
    --k-color-muted: rgba(11,18,32,.66);
    --k-color-muted-2: rgba(11,18,32,.46);
    --k-color-hair: rgba(11,18,32,.14);
    --k-color-hair-2: rgba(11,18,32,.07);

    /* Warm accent */
    --k-color-warm: #7D6B5D;
    --k-color-warm-light: #B8A99A;
    --k-color-warm-tint: rgba(125,107,93,0.08);
    
    /* Deprecated alias: historically used for "dark mode accent".
       Keep as an alias to the real accent token to avoid duct-tape color drift. */
    --k-color-dark-accent: var(--k-color-accent);

    /* Blue system - single flair color */
    --k-color-accent: #1E5AFF;
    --k-color-accent-tint: rgba(30,90,255,0.04);
    --k-color-accent-stroke: rgba(30,90,255,0.28);
    --k-color-accent-hover: rgba(30,90,255,0.18);
    --k-color-accent-ring: rgba(30,90,255,0.22);
    --k-color-accent-shadow: rgba(30,90,255,0.10);
    --k-color-accent-muted: #5B7BA8;
    --k-color-accent-solid-hover: #0D4DE6;

    /* Legacy variable mappings for backward compatibility */
    --bg: var(--k-color-bg);
    --bg-alt: var(--k-color-bg-alt);
    --bgWarm: var(--k-color-bg-warm);
    --bgAlt: var(--k-color-bg-alt-2);
    --ink: var(--k-color-ink);
    --muted: var(--k-color-muted);
    --muted2: var(--k-color-muted-2);
    --hair: var(--k-color-hair);
    --hair2: var(--k-color-hair-2);
    --warm: var(--k-color-warm);
    --warmLight: var(--k-color-warm-light);
    --warmTint: var(--k-color-warm-tint);
    --blue: var(--k-color-accent);
    --blueTint: var(--k-color-accent-tint);
    --blueStroke: var(--k-color-accent-stroke);
    --blueHover: var(--k-color-accent-hover);
    --blueRing: var(--k-color-accent-ring);
    --blueShadow: var(--k-color-accent-shadow);
    --blueMuted: var(--k-color-accent-muted);

    /* Double underline: thick blue over thin gray
     * Values match theme.json settings.custom.underline
     * Note: WordPress doesn't auto-generate CSS vars from theme.json custom,
     * so we maintain these here. Future: migrate to --wp--custom--underline--*
     * if WordPress adds support.
     */
    --k-underline-gray-thickness: 1px;
    --k-underline-blue-thickness: 2px;
    --k-underline-gray-offset: 0px;
    --k-underline-blue-offset: -1px; /* Positioned above gray line */
    --k-underline-gray-color: var(--k-color-hair-2);
    --k-underline-blue-color: var(--k-color-accent);

    /* Data-viz palette (canonical owner) */
    --k-chart-blue: #1E5AFF;
    --k-chart-blue-light: #7BA3FF;
    --k-chart-blue-muted: #B8CEFF;
    --k-chart-warm: #7D6B5D;
    --k-chart-warm-light: #B8A99A;
    --k-chart-warm-muted: #D9CFC4;
    --k-chart-accent: #C9553D;
    --k-chart-accent-light: #E07A62;
    --k-chart-accent-muted: #F0B5A0;
    --k-chart-green: #2ECC71;
    --k-chart-green-light: #7FE0A0;
    --k-chart-green-muted: #C1F0D1;
    --k-chart-gray: #95A5A6;
    --k-chart-gray-light: #BDC3C7;
    --k-chart-gray-muted: #ECF0F1;

    /* 8px spacing system */
    --k-space-1: 8px;
    --k-space-2: 16px;
    --k-space-3: 24px;
    --k-space-4: 32px;
    --k-space-5: 40px;
    --k-space-6: 48px;
    --k-space-8: 64px;
    --k-space-10: 80px;
    --k-space-12: 96px;
    --k-space-15: 120px;
    --k-space-20: 160px;

    /* Legacy spacing mappings */
    --space-1: var(--k-space-1);
    --space-2: var(--k-space-2);
    --space-3: var(--k-space-3);
    --space-4: var(--k-space-4);
    --space-5: var(--k-space-5);
    --space-6: var(--k-space-6);
    --space-8: var(--k-space-8);
    --space-10: var(--k-space-10);
    --space-12: var(--k-space-12);
    --space-15: var(--k-space-15);
    --space-20: var(--k-space-20);

    /* Three-font system */
    --k-font-sans: "Inter", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    --k-font-serif: "Newsreader", ui-serif, Georgia, serif;
    --k-font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    
    /* Handwriting font - Caveat in Italic */
    --k-font-hand: "Caveat", ui-serif, Georgia, serif;
    --hand: var(--k-font-hand);

    /* Legacy typography mappings */
    --sans: var(--k-font-sans);
    --serif: var(--k-font-serif);
    --mono: var(--k-font-mono);

    /* Layout tokens */
    --k-layout-max: 1140px;
    --k-layout-prose: 620px;
    --k-layout-wide: 880px;
    /* Mast height fallback: Use 100px to accommodate tagline wrapping on mid-width viewports.
       Actual value calculated by JS (header.php inline script + main.js).
       Base case ~77px (16px padding + 44px avatar + 16px padding + 1px border),
       but can be taller when tagline wraps. */
    --k-layout-mast-height: 100px;

    /* Legacy layout mappings */
    --max: var(--k-layout-max);
    --prose: var(--k-layout-prose);
    --wide: var(--k-layout-wide);
    --mastH: var(--k-layout-mast-height);
  }
  
  /* ========================================
     DARK MODE TOKENS
     Comprehensive dark mode color overrides
     ======================================== */
  :root[data-theme="dark"] {
    /* Background colors - neutral gray palette (not blue-tinted) */
    --k-color-bg: #1A1A1A;
    --k-color-bg-alt: #252525;
    --k-color-bg-warm: #2A2A2A;
    --k-color-bg-alt-2: #2F2F2F;
    
    /* Text colors */
    --k-color-ink: #f0f0f0;
    --k-color-muted: rgba(240, 240, 240, 0.75);
    --k-color-muted-2: rgba(240, 240, 240, 0.55);
    
    /* Lines/borders */
    --k-color-hair: rgba(201, 184, 168, 0.2);
    --k-color-hair-2: rgba(201, 184, 168, 0.12);
    
    /* Warm colors - brighter in dark mode */
    --k-color-warm: #E8A87C; /* Bright orange - the "bold" dark mode accent */
    --k-color-warm-light: #C9B8A8;
    --k-color-warm-tint: rgba(232, 168, 124, 0.12);
    
    /* Accent system - dark mode uses warm/orange as the primary accent */
    --k-color-accent: var(--k-color-warm);
    --k-color-accent-tint: rgba(232, 168, 124, 0.08);
    --k-color-accent-stroke: rgba(232, 168, 124, 0.35);
    --k-color-accent-hover: rgba(232, 168, 124, 0.18);
    --k-color-accent-ring: rgba(232, 168, 124, 0.25);
    --k-color-accent-solid-hover: color-mix(in srgb, var(--k-color-accent) 86%, #000);
    
    /* Underline colors for dark mode (follows accent system) */
    --k-underline-blue-color: var(--k-color-accent);
    --k-underline-gray-color: rgba(201, 184, 168, 0.25);

    /* --------------------------------------------------------------------
       WordPress preset variable alignment (legibility)
       WP global-styles may define these vars on :root OR on body/.wp-site-blocks.
       Override on :root, and also mirror on body below to prevent dark headings.
       -------------------------------------------------------------------- */
    --wp--preset--color--background: var(--k-color-bg);
    --wp--preset--color--surface: var(--k-color-bg-alt);
    --wp--preset--color--ink: var(--k-color-ink);
    --wp--preset--color--muted: var(--k-color-muted);
    --wp--preset--color--hairline: var(--k-color-hair-2);
    --wp--preset--color--blue: var(--k-color-accent);
    --wp--preset--color--warm: var(--k-color-warm);
    --wp--preset--color--warm-light: var(--k-color-warm-light);
    --wp--preset--color--warm-tint: var(--k-color-bg-warm);

    /* Data-viz palette (dark mode) */
    --k-chart-blue: #6BB3C9;
    --k-chart-blue-light: #8BC9DB;
    --k-chart-blue-muted: #A5D4E5;
    --k-chart-warm: #C9B8A8;
    --k-chart-warm-light: #8B7D6F;
    --k-chart-warm-muted: #5C5248;
    --k-chart-accent: #E07A62;
    --k-chart-accent-light: #E8956E;
    --k-chart-accent-muted: #F0B5A0;
    --k-chart-green: #7FE0A0;
    --k-chart-green-light: #9FE8B8;
    --k-chart-green-muted: #BFF0D0;
    --k-chart-gray: #A0A0A0;
    --k-chart-gray-light: #B8B8B8;
    --k-chart-gray-muted: #3D3D3D;
  }

  :root[data-theme="dark"] body {
    --wp--preset--color--background: var(--k-color-bg);
    --wp--preset--color--surface: var(--k-color-bg-alt);
    --wp--preset--color--ink: var(--k-color-ink);
    --wp--preset--color--muted: var(--k-color-muted);
    --wp--preset--color--hairline: var(--k-color-hair-2);
    --wp--preset--color--blue: var(--k-color-accent);
    --wp--preset--color--warm: var(--k-color-warm);
    --wp--preset--color--warm-light: var(--k-color-warm-light);
    --wp--preset--color--warm-tint: var(--k-color-bg-warm);
  }
}

